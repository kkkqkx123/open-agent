基于对当前项目TUI代码的分析，我发现了工具调用和历史信息处理的实现方式，并提出了以下改进意见：

## 当前实现分析

**优点**：
- 模块化设计：InputHistory、ToolResults、ConversationHistory 等组件职责清晰
- 基本功能完备：支持历史导航、工具结果展示、多类型消息显示
- 状态管理：StateManager 统一管理应用状态

**存在的问题**：

1. **容量限制**：历史消息(50条)和输入历史(100条)有硬性限制，长会话时信息可能丢失
2. **显示简单**：工具结果以文本列表显示，复杂数据结构展示不友好
3. **检索功能缺失**：只有上下导航，缺乏搜索、过滤功能
4. **性能隐患**：大量消息时渲染性能可能下降
5. **交互功能有限**：缺少书签、复制、分享等实用功能
6. **可视化不足**：工具调用关系不够直观
7. **错误处理简单**：失败的工具调用缺乏重试机制
8. **持久化不足**：会话历史依赖手动保存

## 改进建议

### 1. 配置系统扩展
- 增加历史容量配置选项，支持用户自定义限制
- 添加历史管理策略（自动归档、分页等）

### 2. 增强显示功能
- 开发富文本渲染器，支持JSON格式化、表格显示
- 添加折叠/展开功能，优化空间利用
- 实现消息类型过滤（只显示工具消息等）

### 3. 搜索和检索功能
- 添加关键词搜索功能
- 支持时间范围过滤
- 实现消息标签和分类

### 4. 性能优化
- 引入虚拟滚动技术，只渲染可见区域
- 实现消息懒加载机制
- 优化渲染算法减少重绘

### 5. 用户体验提升
- 添加消息书签功能，标记重要信息
- 支持消息复制和分享
- 添加会话摘要自动生成

### 6. 工具调用可视化
- 显示工具调用链和时序关系
- 提供工具性能统计面板
- 实现工作流执行可视化

### 7. 错误处理和重试
- 为失败工具调用添加重试按钮
- 提供详细的调试信息
- 支持参数修改和重新执行

### 8. 持久化和同步
- 实现自动会话历史保存
- 添加历史备份和恢复功能
- 支持跨设备历史同步

## 实施优先级建议

1. **高优先级**：容量配置、搜索功能、性能优化
2. **中优先级**：富文本渲染、错误重试、书签功能  
3. **低优先级**：可视化、自动摘要、跨设备同步

这些改进将显著提升TUI在处理工具调用和历史信息时的能力，特别是在复杂任务和长时间会话场景下提供更好的用户体验。