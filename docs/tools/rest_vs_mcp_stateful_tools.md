# REST工具与有状态工具的区分及实现策略

## 概述

本文档说明了REST工具与有状态工具的区别，以及在系统中实现有状态工具的推荐策略。

## REST工具的特点

### 业务逻辑无状态

当前系统中的REST工具（如fetch、duckduckgo_search、weather等）在业务逻辑上是无状态的，这意味着：

- 每次工具调用都是独立的，不依赖于之前的调用结果
- 工具的执行结果仅取决于输入参数
- 多次调用之间没有依赖关系

### 技术性状态管理

尽管业务逻辑上是无状态的，但REST工具仍使用状态管理器来：

- 维护HTTP连接复用，提高性能
- 实现请求速率限制
- 跟踪连接状态和错误信息

## 有状态工具的定义

有状态工具是指在业务逻辑上需要维护状态的工具，例如：

- 浏览器操作工具：需要维护浏览器会话、页面状态、cookies等
- 数据库连接工具：需要维护数据库连接状态
- 会话管理工具：需要跟踪用户会话状态

## 实现有状态工具的策略

### 推荐方案：MCP（Model Context Protocol）

对于需要真正业务状态管理的工具（如浏览器操作工具），推荐使用MCP协议实现，原因如下：

1. **集中状态管理**：MCP服务器可以更好地管理复杂的状态（如浏览器实例、会话状态）
2. **资源管理**：浏览器实例等资源的创建和销毁可以由专用服务器处理
3. **安全性**：复杂操作（如浏览器操作）可以在隔离的环境中执行
4. **可扩展性**：多个工具实例的管理更适合在专用服务器中处理
5. **故障隔离**：有状态工具的故障不会影响主系统

### 不推荐：扩展REST工具

不建议将当前的REST工具扩展为真正的有状态工具，因为：

- 会破坏REST工具无状态的语义
- 增加系统的复杂性和维护成本
- 可能导致状态管理混乱

## 未来规划

### 浏览器操作工具

浏览器操作工具（如使用Selenium或Playwright实现的工具）应通过MCP协议提供，而不是作为扩展的REST工具。

### 工具分类策略

- `rest`：业务逻辑无状态的工具（当前所有REST工具）
- `mcp`：需要复杂状态管理的工具（如浏览器操作、数据库连接等）

## 结论

通过明确区分业务逻辑无状态的REST工具和需要复杂状态管理的有状态工具，并推荐使用MCP协议实现后者，可以保持系统架构的清晰性和可维护性。