# TUI输入功能用户指南

本文档介绍了TUI界面中的输入功能及使用方法。

## 基本输入功能

### 单行模式（默认模式）
- 在输入框中直接输入文本
- 按 `Enter` 键提交输入内容
- 输入的内容会被发送到后端处理系统

### 多行模式
- 按 `Ctrl+M` 键切换到多行模式
- 在多行模式下可以输入包含换行符的文本
- 在多行模式下，`Enter` 键的行为有所不同：
 - 当光标在非空行时，按 `Enter` 会插入换行符
  - 当光标在空行时，按 `Enter` 会提交整个输入内容

## 特殊输入模式

### 多行输入
在多行模式下，您可以输入包含多个段落的文本：

1. 按 `Ctrl+M` 进入多行模式
2. 输入第一行内容
3. 按 `Enter` 换行并继续输入
4. 在空行按 `Enter` 提交整个内容

### 特殊字符处理
- 反斜杠后跟换行符（`\` + `Enter`）：用于多行输入的延续，会移除反斜杠并添加换行符
- 以空格结尾的输入：直接提交（即使在多行模式下）

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Enter` | 提交输入（单行模式）或换行/提交（多行模式） |
| `Ctrl+M` | 切换多行模式 |
| `Up Arrow` | 浏览输入历史（向上） |
| `Down Arrow` | 浏览输入历史（向下） |
| `Tab` | 命令自动补全 |
| `Backspace` | 删除前一个字符 |
| `Delete` | 删除后一个字符 |
| `Home` | 移动光标到行首 |
| `End` | 移动光标到行尾 |

## 命令系统

TUI支持多种命令，通过特定前缀触发：

### 工作流命令
- `#command` - 选择和操作工作流

### 文件命令
- `@path` - 文件选择和操作

### 系统命令
- `/command` - 执行系统命令

## 多行模式提交逻辑

多行模式下的提交逻辑经过精心设计，以提供最佳用户体验：

1. **非空行按Enter**：插入换行符，继续输入
2. **空行按Enter**：提交当前所有内容
3. **特殊处理**：以空格结尾的输入会直接提交

这种设计允许用户在多行模式下灵活地输入多段文本，并通过在空行按Enter来明确提交意图。

## 输入历史

- 使用 `Up Arrow` 和 `Down Arrow` 键浏览输入历史
- 历史记录会自动保存最近的输入内容
- 在输入框中输入内容后，可以使用方向键浏览历史

## 调试信息

TUI系统会记录详细的输入处理日志，包括：
- 按键事件
- 输入处理过程
- 状态变更
- 渲染操作

这些日志有助于开发人员调试和优化用户体验。

## 常见问题

### Q: 为什么在多行模式下按Enter不提交？
A: 在多行模式下，只有当光标在空行时按Enter才会提交。在非空行按Enter会插入换行符以继续输入多行内容。

### Q: 如何快速切换单行/多行模式？
A: 按 `Ctrl+M` 键可以在单行和多行模式之间切换。

### Q: 如何在多行模式下提交包含空行的内容？
A: 如果需要提交包含空行的内容，可以在最后的非空行按Enter，然后在新出现的空行再次按Enter来提交。