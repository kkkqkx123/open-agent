# OpenAI GPT-4 配置
# 继承自 provider/openai/common.yaml

model_type: openai
model_name: gpt-4
provider: openai
base_url: "https://api.openai.com/v1"
api_key: "${OPENAI_API_KEY}"
token_counter: openai_gpt4

# 继承provider通用配置，只覆盖特定参数
parameters:
  # 基础生成参数（覆盖common.yaml中的默认值）
  temperature: 0.7
  max_tokens: 2000
  max_completion_tokens: null
  top_p: 1.0
  
  # 惩罚参数
  frequency_penalty: 0.0
  presence_penalty: 0.0
  
  # 停止序列
  stop: null
  
  # 采样和概率参数
  top_logprobs: null
  
  # 工具调用参数
  tool_choice: null
  tools: null
  
  # 响应格式
  response_format: null
  
  # 流式和控制参数
  stream: false
  stream_options: null
  
  # 服务和安全参数
  service_tier: "auto"
  safety_identifier: null
  store: false
  
  # 推理参数（新模型）
  reasoning: null
  
  # 详细程度控制
  verbosity: "medium"
  
  # 网络搜索选项
  web_search_options: null
  
  # 其他参数
  seed: null
  user: null
  
  # 连接参数 - GPT-4可能需要更长的超时时间
  timeout: 60
  max_retries: 5

# GPT-4特定的重试配置（覆盖组配置）
retry_config:
  base_delay: 2.0                  # GPT-4频率限制更严格，增加基础延迟
  max_delay: 120.0                 # GPT-4可能需要更长的重试等待时间
  jitter: true
  exponential_base: 2.0
  retry_on_status_codes:
    - 429  # 频率限制
    - 500  # 服务器内部错误
    - 502  # 网关错误
    - 503  # 服务不可用
    - 504  # 网关超时
  retry_on_errors:
    - "timeout"
    - "rate_limit"
    - "service_unavailable"
    - "insufficient_quota"  # GPT-4特有的配额不足错误

# GPT-4特定的超时配置（覆盖组配置）
timeout_config:
  request_timeout: 60              # GPT-4响应时间较长，增加请求超时
  connect_timeout: 15              # 连接超时也适当增加
  read_timeout: 60                 # 读取超时时间
  write_timeout: 30                # 写入超时时间

# 缓存配置（继承自provider配置）
supports_caching: false  # OpenAI不直接支持API级缓存
cache_config:
  enabled: false
  ttl_seconds: 3600
  max_size: 1000

# 降级配置
fallback_enabled: true
fallback_models:
  - openai-gpt3.5-turbo
max_fallback_attempts: 3

# 元数据
metadata:
  provider: openai
  version: "1.0"
  description: "OpenAI GPT-4 模型"
  model_family: "gpt-4"
  capabilities:
    - text_generation
    - function_calling
    - streaming
    - vision
  limitations:
    - no_api_caching