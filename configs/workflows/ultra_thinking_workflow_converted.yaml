config_type: workflow
description: 多Agent并行探索工作流，适用于多维度分析和创新问题解决
edges:
- description: 开始Agent配置
  from: initial
  to: agent_configuration
  type: simple
- description: 进入并行分析阶段
  from: agent_configuration
  to: parallel_analysis
  type: simple
- condition: all_completed
  description: 所有Agent分析完成，进入结果整合
  from: parallel_analysis
  to: solution_integration
  type: conditional
- condition: partial_failure
  description: 部分Agent失败，重新配置
  from: parallel_analysis
  to: agent_configuration
  type: conditional
- description: 进入协作验证阶段
  from: solution_integration
  to: collaborative_validation
  type: simple
- condition: validation_passed
  description: 验证通过，进入最终优化
  from: collaborative_validation
  to: final_refinement
  type: conditional
- condition: validation_failed
  description: 验证失败，重新整合方案
  from: collaborative_validation
  to: solution_integration
  type: conditional
- description: 进入最终状态
  from: final_refinement
  to: final
  type: simple
entry_point: initial
error_handling:
  error_messages:
    agent_configuration_failed: Agent配置生成失败
    consensus_not_reached: 验证共识未达成
    integration_failed: 结果整合失败
    parallel_execution_timeout: 并行执行超时
  fallback_state: final
  max_retries: 2
  partial_success_threshold: 0.6
  retry_delay: 10000
input_schema:
  properties:
    integration_strategy:
      default: weighted
      description: 结果整合策略
      enum:
      - weighted
      - consensus
      - hierarchical
      type: string
    max_agents:
      default: 5
      description: 最大Agent数量
      maximum: 8
      minimum: 2
      type: integer
    problem:
      description: 需要分析的问题描述
      required: true
      type: string
    temperature:
      default: 0.8
      description: LLM温度参数
      maximum: 1.0
      minimum: 0.0
      type: number
    validation_threshold:
      default: 0.7
      description: 验证阈值
      maximum: 1.0
      minimum: 0.0
      type: number
  type: object
max_iterations: 10
metadata:
  author: Open Agent Team
  category: collaboration
  created_date: '2025-11-10'
  tags:
  - ultra-thinking
  - multi-agent
  - collaboration
  - innovation
monitoring:
  enable_metrics: true
  log_level: debug
  metrics:
  - execution_time
  - agent_count
  - success_rate
  - validation_score
  - token_usage_per_agent
  - parallel_execution_efficiency
name: ultra_thinking_workflow
nodes:
  agent_configuration:
    config:
      configuration_prompt: '基于以下问题，生成多Agent分析配置：


        问题：{{input.problem}}

        最大Agent数量：{{input.max_agents}}


        请为每个Agent配置：

        1. Agent名称和专业领域

        2. 分析视角和重点

        3. 专用的提示词模板

        4. 预期输出格式


        确保Agent视角互补，覆盖问题的不同维度。

        '
      default_perspectives:
      - technical
      - business
      - user_experience
      - ethical
      - innovative
      max_agents: '{{input.max_agents}}'
      model: gpt-4
      temperature: '{{input.temperature}}'
    description: 动态生成多Agent配置
    function: agent_configuration_node
  collaborative_validation:
    config:
      collaboration_mode: consensus
      validation_prompt: '请各专家对以下综合解决方案进行验证评估：


        问题：{{input.problem}}

        综合解决方案：{{states.solution_integration.output}}


        各专家请从自己的专业角度评估：

        1. 方案在您专业领域的可行性和优势

        2. 可能存在的问题和改进建议

        3. 整体评分（0-1分）


        最终需要达成共识或加权评估。

        '
      validation_threshold: '{{input.validation_threshold}}'
    description: 多Agent协作验证解决方案
    function: collaborative_validation_node
  final:
    config: {}
    description: 工作流完成状态
    function: end_node
  final_refinement:
    config:
      model: gpt-4
      prompt: '基于各专家的验证反馈，对解决方案进行最终优化：


        原始问题：{{input.problem}}

        综合解决方案：{{states.solution_integration.output}}

        验证反馈：{{states.collaborative_validation.output}}


        请：

        1. 吸收各专家的合理建议

        2. 优化解决方案的不足之处

        3. 确保方案更加完善和可执行

        4. 生成最终的优化版本


        优化后的方案应该更加成熟和全面。

        '
      temperature: 0.3
    description: 基于验证反馈进行最终优化
    function: llm_node
  initial:
    config: {}
    description: 工作流开始状态
    function: start_node
  parallel_analysis:
    config:
      default_nodes:
        business_agent:
          config:
            model: gpt-4
            prompt: '作为商业专家，从商业价值角度分析问题：


              问题：{{input.problem}}


              请提供：

              1. 商业价值和市场潜力

              2. 盈利模式和商业模式

              3. 市场竞争分析

              4. 投资回报评估


              分析要务实、有商业洞察力。

              '
            temperature: '{{input.temperature}}'
          description: 商业专家视角分析
          name: business_agent
          type: llm_node
        technical_agent:
          config:
            model: gpt-4
            prompt: '作为技术专家，从技术实现角度分析问题：


              问题：{{input.problem}}


              请提供：

              1. 技术可行性分析

              2. 实现方案和技术架构

              3. 技术风险和挑战

              4. 技术创新的可能性


              分析要深入、专业，考虑最新的技术趋势。

              '
            temperature: '{{input.temperature}}'
          description: 技术专家视角分析
          name: technical_agent
          type: llm_node
        user_experience_agent:
          config:
            model: gpt-4
            prompt: '作为用户体验专家，从用户角度分析问题：


              问题：{{input.problem}}


              请提供：

              1. 用户体验影响分析

              2. 用户接受度和易用性

              3. 用户痛点和需求满足

              4. 用户体验改进建议


              分析要以用户为中心，注重人性化设计。

              '
            temperature: '{{input.temperature}}'
          description: 用户体验专家视角分析
          name: user_experience_agent
          type: llm_node
      max_concurrent: '{{input.max_agents}}'
      nodes: '{{states.agent_configuration.output.agent_configs}}'
      timeout_ms: 180000
    description: 并行执行多个Agent的分析任务
    function: parallel_node
  solution_integration:
    config:
      integration_prompt: '基于以下多个专家的分析结果，整合生成综合解决方案：


        问题：{{input.problem}}


        各专家分析结果：

        {{#each states.parallel_analysis.output}}

        {{@key}}专家：{{this.output}}

        {{/each}}


        请整合生成综合解决方案，要求：

        1. 综合考虑各专家的视角和建议

        2. 平衡技术可行性、商业价值和用户体验

        3. 提出创新性的综合解决方案

        4. 制定实施路线图和优先级


        解决方案应该全面、平衡、可执行。

        '
      model: gpt-4
      strategy: '{{input.integration_strategy}}'
      temperature: 0.5
    description: 整合多个Agent的分析结果
    function: solution_integration_node
state_schema:
  fields:
    errors:
      default: []
      description: 错误列表
      reducer: extend
      type: List[str]
    input:
      default: ''
      description: 输入文本
      type: str
    messages:
      default: []
      description: 消息列表
      reducer: extend
      type: List[dict]
    output:
      default: ''
      description: 输出文本
      type: str
  name: WorkflowState
timeout: 300
version: 1.0.0
workflow_name: ultra_thinking_workflow
